# LENTA_hakaton

## Прогноз спроса на товары собственного производства сети продуктовых магазинов ЛЕНТА

*Решение задачи по предсказательной модели и его интерфейса по прогнозированию спроса на товары заказчика - собственного производства Лента (скоропортящиеся товары)*

**Заказчик:** ООО “ЛЕНТА”

**Бизнес цель:**
- Разработать прогностический инструмент для планирования приготовления продуктов собственного производства (кухня, пекарня и пр.).

**Побочная бизнес цель:**
При получении точных прогнозов ожидается:
- снижение объема упущенных продаж,
- уменьшение числа списаний по сроку годности,
- повышение доступности товаров на полке,
- увеличение продаж.

## Постановка задачи:
- создать алгоритм прогноза спроса на 14 дней для товаров собственного производства
- гранулярность Магазин-SKU-День

**Финальный результат:**
Отчет/таблица, в которой построен прогноз спроса по товарам, в каком количестве необходимо их приготовить в каждом магазине.

**Источник данных:** Хакатон Лента.

**Целевой признак:** sales_units – общее число проданных товаров (шт.)

**Метрика качества:** WAPE, посчитанный на уровне товара, магазина, дня.

**Метод для подсчета WAPE:**
```python
def wape(y_true: np.array, y_pred: np.array):
    return np.sum(np.abs(y_true-y_pred))/np.sum(np.abs(y_true))
```
**Стек:**
- временные ряды, pandas, numpy, seaborn, matplotlib, phik, CatBoost, ORBIT, ARIMAX, pickle, sklearn (pipeline, preprocessing, cluster)

## Описание проекта

**Данные:**

- `sales_df_train.csv` – данные по продажам за скользящий год для обучения.
- `pr_df.csv` – данные по товарной иерархии.
- `pr_st.csv` – данные по магазинам.
- `sales_submission.csv` – пример файла с результатом работы модели прогноза спроса.

**Описание данных:**

- `sales_df_train.csv` – данные по продажам за скользящий год для обучения.
    - Столбцы:
        - `st_id` перевод в `store` – захэшированное id магазина;
        - `pr_sku_id` перевод в `sku` – захэшированное id товара;
        - `date` – дата;
        - `pr_sales_type_id` перевод в `sales_type` – флаг наличия промо;
        - `pr_sales_in_units` перевод в `sales_units` – общее число проданных товаров (шт.);
        - `pr_promo_sales_in_units` перевод в `sales_units_promo` – число проданных товаров с признаком промо;
        - `pr_sales_in_rub` перевод в `sale_rub` – продажи в РУБ всего (промо и без);
        - `pr_promo_sales_in_rub` перевод в `sale_rub_promo` – продажи с признаком промо в РУБ;

- `pr_df.csv` – данные по товарной иерархии. От большего к меньшему `pr_group_id - pr_cat_id - pr_subcat_id - pr_sku_id`.
    - Столбцы:
        - `pr_group_id` перевод в `group` – захэшированная группа товара;
        - `pr_cat_id` перевод в `category` – захэшированная категория товара;
        - `pr_subcat_id` перевод в `subcategory` – захэшированная подкатегория товара;
        - `pr_sku_id` перевод в `sku` – захэшированное id товара;
        - `pr_uom_id` перевод в `uom` - (маркер, обозначающий продаётся товар на вес или в ШТ).

- `pr_st.csv` – данные по магазинам.
    - Столбцы:
        - `st_id` перевод в `store` – захэшированное id магазина;
        - `st_city_id` перевод в `city` – захэшированное id города;
        - `st_division_code id` перевод в `division` – захэшированное id дивизиона;
        - `st_type_format_id` перевод в `type_format` – id формата магазина;
        - `st_type_loc_id` перевод в `loc` – id тип локации/окружения магазина;
        - `st_type_size_id` перевод в `size` – id типа размера магазина;
        - `st_is_active` перевод в `is_active` – флаг активного магазина на данный момент.

- `sales_submission.csv` – пример файла с результатом работы модели прогноза спроса. Необходимо подготовить файл в таком же формате, заполнив колонку `target` предсказаниями (по умолчанию колонка заполнена нулями).
    - Столбцы:
        - `st_id` – захэшированное id магазина;
        - `pr_sku_id` – захэшированное id товара;
        - `date` – дата (день);
        - `target` – спрос в шт.

## Описание результата:
- Модель строит на прогноз в 14 дней.
- Метрика качества для 2-х наиболее активных по продажам магазинах и 2-х самых продаваемых товарах составляет WAPE = 19%.
- Для реализации задачи обучена модель CatBoostRegressor.
- Данные подаются в продакшн.

## Команда DS:
- Алла Мишра
- Михаил Грибанов
- Ирина Балычева

